<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
</head>

<body>
  hello world
  <br>
  <div id="allShares"></div>
  <br>
  <form id="myform" enctype="multipart/form-data">
    <input type="text" id="description" name="description">
    <input type="file" id="files" name="filename" multiple>
    <input type="submit" id="formSubmit">
  </form>

  <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
  <script>
    window.addEventListener('load', async () => {

      async function submitFile(event) {
        event.preventDefault();
        const files = document.getElementById("files");
        const description = document.getElementById('description')

        if (files.files.length === 0) {
          return
        }

        // if (description.value === "") {
        //   return
        // }
        const form = document.getElementById('myform');
        const data = new FormData()


        for (let i = 0; i < files.files.length; i++) {
          data.append("files", files.files[i]);
        }

        const response = await axios.post('/shares', data)

        const shares = await getAllShares()
        updateShares(shares)
        resetform()
        // return False
      }

      formSubmit = document.getElementById("formSubmit")
      formSubmit.addEventListener("click", submitFile)

      async function getAllShares() {
        const response = await axios.get('/shares/all')
        return response.data
      }

      const updateShares = (shares) => {
        sharesEl = document.getElementById("allShares")
        sharesEl.innerHTML = ""
        shares.map((share) => {
          sharesEl.innerHTML += "<a href=" + share.id + ">" + share.id + "</a>"
          sharesEl.innerHTML += "<br>"
        })
      }

      const resetform = () => {
        document.getElementById("myform").reset();
      }

      const shares = await getAllShares()
      updateShares(shares)

    });
  </script>
</body>




</html>
